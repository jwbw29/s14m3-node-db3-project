# Node DB3 Project Starter Code

## Task 1: Project Setup and Submission

Your assignment page on Canvas should contain instructions for submitting this project. If you are still unsure, reach out to School Staff.

## Task 2: Project Minimum Viable Product

### Database

Open `data/schemes.db3` using a graphical tool like SQLite Studio and study the data inside the `schemes` and `steps` tables. The data can be reset at any time by executing `npm run seed`.

### API

Open `api/schemes/scheme-router.js` and study the specification for each endpoint. You do not need to make any changes to this file.

- `[GET] /api/schemes`
- `[GET] /api/schemes/:scheme_id`
- `[GET] /api/schemes/:scheme_id/steps`
- `[POST] /api/schemes`
- `[POST] /api/schemes/:scheme_id/steps`

### Middleware Functions

Write middleware functions in `api/schemes/scheme-middleware.js` following the instructions inside that file:

- [x] `checkSchemeId`
- [x] `validateScheme`
- [x] `validateStep`

### Database Functions

Write db access functions in `api/schemes/scheme-model.js` following the instructions inside that file:

- [x] `find`
- [x] `findById`
- [ ] `findSteps`
- [ ] `add`
- [ ] `addStep`

#### Schemes Schema

| field       | data type        | metadata                                      |
| :---------- | :--------------- | :-------------------------------------------- |
| scheme_id   | unsigned integer | primary key, auto-increments, generated by db |
| scheme_name | string           | required, unique                              |

#### Steps Schema

| field        | data type        | metadata                                           |
| :----------- | :--------------- | :------------------------------------------------- |
| step_id      | unsigned integer | primary key, auto-increments, generated by db      |
| scheme_id    | unsigned integer | foreign key referencing scheme.scheme_id, required |
| step_number  | unsigned integer | required                                           |
| instructions | string           | required                                           |

### Notes

- Run tests locally executing `npm test`.
- You are welcome to create additional modules but do not move or rename existing files or folders.
- Do not change your `package.json` file except to install additional libraries or add additional scripts.
- In your solution it is essential that you follow best practices and produce clean and professional results.
- Schedule time to review, refine, and assess your work.
- Perform basic professional polishing including spell-checking and grammar-checking on your work.

## Task 3: Multi Table Queries

Use a graphical tool like SQLite Studio to open `./data/northwind.db3` and execute the following queries:

(Write the queries inside `./queries.sql` under the corresponding comment)

- Display the ProductName and CategoryName for all products in the database. Returns 77 records.
- Display the order Id and shipper CompanyName for all orders placed before August 9 2012. Returns 429 records.
- Display the name and quantity of the products ordered in order with Id 10251. Sort by ProductName. Returns 3 records.
- Display the OrderID, customer's Company Name and the employee's Last Name for every order. All columns should be labeled clearly. Returns 16,789 records.

## Task 4: Stretch Problems

In [SQL Try Editor at W3Schools.com](https://www.w3schools.com/Sql/tryit.asp?filename=trysql_select_top):

- Find the number of shipments by each shipper.
- Find the top 5 best performing employees measured in number of orders.
- Find the top 5 best performing employees measured in revenue.
- Find the category that brings in the least revenue.
- Find the customer country with the most orders.
- Find the shipper that moves the most cheese measured in units.

<!--
# Tests

[x] [0] sanity check (30 ms)
    - server.js

## [GET] /api/schemes

[x] [1] gets all the schemes from db, including schemes _without_ steps (LEFT VS. INNER JOIN !!!) (17 ms)
[x] [2] the schemes returned have a `scheme_id` key (6 ms)
[x] [3] the schemes returned have a `scheme_name` key (5 ms)
[x] [4] the schemes returned have a `number_of_steps` key (5 ms)
[x] [5] the schemes arrive sorted by `scheme_id` ascending (6 ms)
[x] [6] each scheme returned has the correct `number_of_steps` (5 ms)

## [GET] /api/schemes/:scheme\*id

[x] [7] the scheme returned has the correct `scheme_id` \_number\* (10 ms)
[x] [8] the scheme returned has the correct `scheme_name` (5 ms)
[x] [9] the scheme returned has a `steps` property which is an array (5 ms)
[x] [10] the scheme returned has an empty `steps` array if the scheme has no steps (4 ms)
[x] [11] the scheme returned has the correct number of steps (5 ms)
[x] [12] each step inside the scheme returned has `step_id`, `step_number` and `instructions` keys (4 ms)
[x] [13] the steps inside the scheme returned are ordered by `step_number` ascending (8 ms)
[x] [14] responds with 404 and proper error on non-existing `scheme_id` (9 ms)

## [GET] /api/schemes/:scheme_id/steps

[ ] [15] returns the correct number of steps for a `scheme_id` (10 ms)
[ ] [16] the steps returned are ordered by `step_number` ascending (5 ms)
[ ] [17] the steps returned have the proper `step_number`, `step_id`, `instructions` and `scheme_name` (4 ms)
[x] [18] responds with 404 and proper error on non-existing `scheme_id` (4 ms)

## [POST] /api/schemes

[ ] [19] can create a new scheme in the database (13 ms)
[ ] [20] responds with 201 status code (4 ms)
[ ] [21] responds with the newly created scheme record (5 ms)
[x] [22] responds with 400 and proper message on missing or bad `scheme_name` (5 ms)

## [POST] /api/schemes/:scheme_id/steps

[ ] [23] can create a new step in the database (5 ms)
[ ] [24] responds with 201 status code (4 ms)
[ ] [25] responds with the complete list of steps for the given `scheme_id` including the new one (5 ms)
[ ] [26] responds with well formed steps ordered by `step_number` ascending (4 ms)
[x] [27] responds with 400 and proper message on missing or bad `step_number` or `instructions` (7 ms)
-->
